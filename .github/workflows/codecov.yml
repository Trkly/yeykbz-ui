# .github/workflows/main.yml
# This is a basic workflow to help you get started with Actions

name: æµ‹è¯•è¦†ç›–ç‡

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the master branch
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

# è¿™ä¸ªå·¥ä½œæµçš„åç§°
# name: CI
jobs:
  CodeCov:
    # è¿™ä¸ªå·¥ä½œæµçš„åç§°
    name: CodeCov æµ‹è¯•è¦†ç›–ç‡ ğŸ“Š
    runs-on: ubuntu-latest
    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      - name: è¯»å–ä»“åº“å†…å®¹ ğŸ’
        uses: actions/checkout@v2
      - name: å®‰è£… pnpm â­
        uses: pnpm/action-setup@v4.1.0
        with:
          version: 10.5.2
      - name: éªŒè¯ pnpm æ˜¯å¦å¯æ‰§è¡Œ ğŸŒ 
        run: which pnpm # è°ƒè¯•ç”¨ï¼Œç¡®è®¤è·¯å¾„
      - name: å®‰è£…ä¾èµ– ğŸ³ï¸â€ğŸŒˆ
        run: pnpm install
      - name: è¿è¡Œæµ‹è¯• ğŸ›¸
        run: pnpm coverage
      - name: ä¸Šä¼ æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š ğŸ“Š
        uses: codecov/codecov-action@v5
        with:
          directory: coverage
          token: ${{ secrets.CODECOV_TOKEN }}
